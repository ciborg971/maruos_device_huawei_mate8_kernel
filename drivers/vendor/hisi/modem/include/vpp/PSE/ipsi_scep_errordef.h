/******************************************
Copyright (C), 2004, Huawei Tech. Co., Ltd.
FileName: ipsi_scep_errordef.h
Version: 1
Author:  Vijaya
Creation Date: 2010-06-04
Description: This file declares the error
codes

Function List:


History:<author>   <date>          <desc>
              
*********************************************/
#include "ipsi_pse_build_conf.h"
#ifndef __IPSI_SEC_NO_SCEP__

#ifndef __IPSI_SCEP_ERROR_DEF_H__
#define __IPSI_SCEP_ERROR_DEF_H__


#ifdef  __cplusplus
extern "C" {
#endif

#define IPSI_SCEP_ERR_RANGE 1000
    
#define IPSI_SCEP_ERR_INIT 55000
    
// System Error: Include mem allocation failure,socket  closed , 
// file open error......
#define IPSI_SCEP_ERR_SYSTEM_INIT (IPSI_SCEP_ERR_INIT + 1)

//MAX Total System error limit
#define IPSI_SCEP_ERR_SYSTEM_LIMIT \
    (IPSI_SCEP_ERR_SYSTEM_INIT + IPSI_SCEP_ERR_RANGE - 1)

#define IPSI_SCEP_ERR_COMMON_INIT (IPSI_SCEP_ERR_SYSTEM_LIMIT + 1)

//MAX Total Common error limit
#define IPSI_SCEP_ERR_COMMON_LIMIT \
(IPSI_SCEP_ERR_COMMON_INIT + IPSI_SCEP_ERR_RANGE - 1)

/** @defgroup SCEP
* This section contains the SCEP Functions.
*/

//enum to hold system errors
enum
{
    IPSI_SCEP_ERR_MALLOC_FAILED = IPSI_SCEP_ERR_SYSTEM_INIT,
    IPSI_SCEP_ERR_MEMCPY_FAILED,
    IPSI_SCEP_ERR_STRNCPY_FAILED,
    IPSI_SCEP_ERR_SNPRINTF_FAILED,

    // Please add all error between init and max
    IPSI_SCEP_ERR_SYSTEM_MAX
    
};


//enum to  hold the common errors
enum
{
    //Invalid arguments
    IPSI_SCEP_ERR_INVALID_ARGS = IPSI_SCEP_ERR_COMMON_INIT,

    //Invalid digest algorithm
    IPSI_SCEP_INVALID_DIGEST_ALGO,

    //Invalid encryption algorithm
    IPSI_SCEP_INVALID_ENCRYPTION_ALGO,

    //Reading the client certificate from file failed
    IPSI_SCEP_ERR_READ_CLIENT_CERT_FILE_FAILED,

    //Reading the client key from file failed
    IPSI_SCEP_ERR_READ_CLIENT_KEY_FILE_FAILED ,

    //Reading the client certificate from buffer failed
    IPSI_SCEP_ERR_LOAD_CLIENT_CERT_FROM_BUFFER_FAILED,

    IPSI_SCEP_ERR_EXTN_CERT_CREATION_FAILED,

    IPSI_SCEP_ERR_NO_CERT_LOADED,

    IPSI_SCEP_ERR_DUP_CERT_FAILED,

    IPSI_SCEP_ERR_RA_CERT_LIST_EXCEED_MAX_LIMIT,

    IPSI_SCEP_ERR_LOAD_RA_CA_CERTS_FAILED,

    IPSI_SCEP_ERR_EXTRACT_PUB_KEY_FAILED,

    IPSI_SCEP_ERR_GET_CERT_FROM_RA_LIST_FAILED,

    IPSI_SCEP_ERR_RA_VALIDATION_FAILED,

    IPSI_SCEP_ERR_GET_KEY_USAGE_EXTN_FAILED,

    IPSI_SCEP_ERR_FOUND_MORE_THAN_ONE_RACERT_WITH_ALL_CAPS,

    IPSI_SCEP_ERR_NO_RA_HAS_REQUIRED_CAPS,

    IPSI_SCEP_ERR_ALGORITHM_NOT_SUPPORTED,

    IPSI_SCEP_ERR_KEY_SIZE_NOT_SUPPORTED,

    IPSI_SCEP_ERR_NAME_MISMATCH,

    IPSI_SCEP_ERR_SIGN_VERIFY_FAILED,

    IPSI_SCEP_ERR_ERROR_IN_DECODING_KEY_USAGE_EXTN,

    IPSI_SCEP_ERR_LOAD_KEY_BUFFER_FAILED,

    IPSI_SCEP_ERR_CERT_KEY_MATCH_FAILED,

    IPSI_SCEP_ERR_CRYPT_NEW_KEY_FAILED,

    IPSI_SCEP_ERR_CRYPT_COPY_KEY_FAILED,

    IPSI_SCEP_ERR_DUPLICATE_REQUESTID,

    IPSI_SCEP_ERR_NO_MATCH_REQUESTID_FOUND,

    IPSI_SCEP_ERR_MAP_NOT_CREATED,

    IPSI_SCEP_ERR_ONE_RA_WITH_ALL_CAPS_OTHER_RA_WITH_NO_CAPS,

    IPSI_SCEP_ERR_STORE_FULL,

    IPSI_SCEP_ERR_INVALID_CONTENT_TYPE,

    IPSI_SCEP_ERR_GET_CA_CERT_RESP_VALIDATION_FAILED,

    IPSI_SCEP_ERR_DECODE_FAILED,

    IPSI_SCEP_ERR_INVALID_SIGN_ALGID,

    IPSI_SCEP_ERR_FINGER_PRINT_GENERATION_FAILED,

    IPSI_SCEP_ERR_FINGER_PRINT_LENGTH_NOT_MATCHING,

    IPSI_SCEP_ERR_FINGER_PRINT_VALIDATION_FAILED,

    IPSI_SCEP_ERR_BASIC_CONSTRAINTS_CHECK_FAILED,

    IPSI_SCEP_ERR_EXTRACT_CERT_LIST_FAILED,

    IPSI_SCEP_ERR_CA_RA_LIST_EXCEED_MAX_LIMIT,

    IPSI_SCEP_ERR_CA_CERTIFICATE_NOT_FOUND,

    IPSI_SCEP_ERR_FINGER_PRINT_NOT_SET_TO_SCEP_OBJECT,

    IPSI_SCEP_ERR_INSERT_REQUEST_ID_FAILED,

    IPSI_SCEP_ERR_SEND_GET_CA_CERT_REQ_FAILED,

    IPSI_SCEP_ERR_GET_REQUEST_ID_FAILED,

    IPSI_SCEP_ERR_REMOVE_REQUEST_ID_FAILED,

    IPSI_SCEP_ERR_REQ_ID_NOT_FOUND,

    IPSI_SCEP_ERR_NULL_CONTENT_TYPE_POINTER,

    IPSI_SCEP_ERR_CLIENT_CERT_NOT_LOADED,

    IPSI_SCEP_ERR_CA_RA_CERT_NOT_LOADED,

    IPSI_SCEP_ERR_CREATE_SENDER_NONCE_FAILED,

    IPSI_SCEP_ERR_CREATE_CERT_QUERY_FAILED,

    IPSI_SCEP_ERR_ENCODE_SCEP_MESSAGE_FAILED,

    IPSI_SCEP_ERR_ENCODE_MSG_TO_BASE64_FAILED,

    IPSI_SCEP_ERR_SEND_GET_CERT_REQ_FAILED,

    IPSI_SCEP_ERR_CREATE_ENV_SIGN_DATA_FAILED,

    IPSI_SCEP_ERR_DECODE_SCEP_MSG_FAILED,

    IPSI_SCEP_ERR_INVALID_GET_CERT_RESP_STATUS,

    IPSI_SCEP_ERR_EXTRACT_CONT_FROM_MSG_FAILED,

    IPSI_SCEP_ERR_INVALID_RESP_MSG_TYPE,

    IPSI_SCEP_ERR_GET_RECP_NONCE_FAILED,

    IPSI_SCEP_ERR_MATCHING_NONCE_FAILED,

    IPSI_SCEP_ERR_GET_CERT_FAILED,

    IPSI_SCEP_ERR_SIGNATURE_VERIFICATION_FAILED,

    IPSI_SCEP_ERR_SEND_REQ_FAILED,

    IPSI_SCEP_ERR_OBJ_INSERT_REQUEST_ID_FAILED,

    IPSI_SCEP_ERR_SERVER_GET_CERT_RESP_FAILED, 

    IPSI_SCEP_ERR_CA_CLIENT_CERT_NOT_LOADED,

    IPSI_SCEP_ERR_SEND_GET_CA_CAPS_REQ_FAILED,

    IPSI_SCEP_ERR_SEND_GET_CERT_ENROLL_FAILED,

    IPSI_SCEP_ERR_CREATE_PKCS10_REQ_FAILED,

    IPSI_SCEP_ERR_CREATE_PUBKEY_INFO_DIGEST_FAILED,

    IPSI_SCEP_ERR_ENCODE_PUBKEY_INFO_FAILED,

    IPSI_SCEP_ERR_CREATE_KEY_USAGE_EXT_FAILED,

    IPSI_SCEP_ERR_CREATE_EXTENDED_KEY_USAGE_FAILED,

    IPSI_SCEP_ERR_SUB_NAME_DUP_FAILED,

    IPSI_SCEP_ERR_SERVER_GET_CRL_RESP_FAILED,

    IPSI_SCEP_ERR_CREATE_CRL_QUERY_FAILED,

    IPSI_SCEP_ERR_SEND_GET_CRL_REQ_FAILED,

    IPSI_SCEP_ERR_GET_CRL_FAILED,

    IPSI_SCEP_ERR_KEY_PAIR_MATCH_FAILED,

    IPSI_SCEP_ERR_INVALID_EXTEN_KEY_USAGE_FLAG,

    IPSI_SCEP_ERR_ONLY_RSA_KEY_TYPE_SUPPORTED,

    IPSI_SCEP_ERR_SERVER_ENROLL_CERT_RESP_FAILED,

    IPSI_SCEP_ERR_DECODE_ENC_DEGEN_SIGN_DATA_MSG_FAILED,

    IPSI_SCEP_ERR_INVALID_CERTIFICATE_REQUEST_ARGS,

    IPSI_SCEP_ERR_INVALID_CHALLENGE_PASSWORD,

    IPSI_SCEP_ERR_GET_CA_CERT_FAILED_FROM_NXT_CA_RESP_CERT_LIST,

    IPSI_SCEP_ERR_SEND_GET_NXT_CA_REQ_FAILED,

    IPSI_SCEP_ERR_GET_CONTENT_FROM_PKCS7_MSG_FAILED,

    IPSI_SCEP_ERR_GET_NXT_CA_RESP_VALIDATION_FAILED,

    IPSI_SCEP_ERR_EXTRACT_ENC_PKCS7_MSG_FAILED,

    IPSI_SCEP_ERR_ADD_CHALL_PASS_FAILED,

    IPSI_SCEP_ERR_ADD_KEY_EXT_FAILED,

    IPSI_SCEP_ERR_ADD_EXTENDED_KEY_EXT_FAILED,

    IPSI_SCEP_ERR_ADD_EXT_FROM_LIST_FAILED,

    IPSI_SCEP_ERR_SIGN_PKCS10_REQ_FAILED,

    IPSI_SCEP_ERR_SHA512_512_KEY_NOT_SUPPORTED,

    IPSI_SCEP_ERR_RANDOM_NUMBER_GEN_FAILED,

    IPSI_SCEP_ERR_COMMON_MAX

};


// Gives the error code
#define IPSI_SCEP_ERR_REASON_CODE(err)\
    (err & 0x0000FFFF)

// Gives the function code where error is occured
#define IPSI_SCEP_FUNC_REASON_CODE(err)\
    (err >> 16)


#ifdef  __cplusplus
}
#endif

#endif  //__IPSI_SCEP_ERROR_DEF_H__

#endif   // __IPSI_SEC_NO_SCEP__
